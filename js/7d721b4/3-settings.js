Sydney.settings=function(){function m(a,e){var b=n(a),d=c[a];c[a].prop!==e&&(c[a]={ts:Sydney.globals.getTimestamp(),prop:e},Sydney["user-data"].setOfflineData(g+a,c[a]),b.sync_online&&p(a),k(a),b.update_callback(e,d.prop,!1))}function u(a){m(a.setting,a.prop)}function k(a){Sydney["list-nav"].setListItemActive(h,{type:"setting-prop",setting:a,prop:c[a].prop},!0,!1)}function p(a){var e=n(a);e.sync_online&&Sydney["user-data"].getOnlineData(g+a,q,function(b,d,f){"success"===b?d.ts>c[a].ts&&d.prop!==c[a].prop?
(c[a]=d,Sydney["user-data"].setOfflineData(g+a,c[a]),k(a),e.update_callback(c[a].prop)):d.ts<c[a].ts?l(a,f):d.ts===r.ts&&d.lang!==r.lang&&l(a,f):"no-saved-data"===b&&l(a,f)})}function l(a,e){Sydney["user-data"].setOnlineData(g+a,c[a],e,q,function(){})}function n(a){return _.find(j,function(e){return e.name===a})}var h,r={ts:0,lang:"default"},q=[{setting:"use-time-ago-conversion",property:"ts"}],j,c={},g="maol-setting-";return{init:function(){h=$("#settings-list");$("#settings-help-button");var a=
{"text-size":function(a,b,d){var c="text-size-"+a,s=Sydney.globals.$htmlEl;d||s.removeClass("text-size-"+b);s.addClass(c);Sydney.events.trigger("settings","textSizeChanged",a)},language:function(a,b,d){d||(Sydney.events.trigger("settings","languageChanged",a),setTimeout(function(){location.reload(!0)},200))},animations:function(a){var b=Sydney.globals.$htmlEl;"enabled"===a?($listEls=$(".list-navigation"),$listEls.addClass("transitions-disabled"),b.addClass("animations-enabled"),b.removeClass("animations-disabled"),
setTimeout(function(){$listEls.removeClass("transitions-disabled")},0)):(b.removeClass("animations-enabled"),b.addClass("animations-disabled"))},"bookmarks-order-by":function(a){Sydney.events.trigger("settings","bookmarksOrderByChanged",a)}};j=[{name:"text-size",title:t("settings.text_size_title"),sync_online:!1,props:[{name:"small",title:t("settings.text_size_small_title")},{name:"medium",title:t("settings.text_size_medium_title")},{name:"large",title:t("settings.text_size_large_title")}],defaultProp:"medium",
update_callback:a["text-size"]},{name:"animations",title:t("settings.anim_title"),sync_online:!1,props:[{name:"enabled",title:t("settings.anim_enabled_title")},{name:"disabled",title:t("settings.anim_disabled_title")}],defaultProp:"enabled",update_callback:a.animations},{name:"bookmarks-order-by",title:t("settings.bookmarks_order_by_title"),sync_online:!1,props:[{name:"alphabet",title:t("settings.bookmarks_order_by_alphabet_title")},{name:"category",title:t("settings.bookmarks_order_by_category_title")}],
defaultProp:"category",update_callback:a["bookmarks-order-by"]}]},start:function(){Sydney["list-nav"].createList(h,{levels:{1:{css_class:"header-list-item",active:!0,allow_multiple_actives:!0,expandable:!0},2:{css_class:"setting-list-item",active:!1,allow_multiple_actives:!0,expandable:!0},3:{css_class:"setting-prop-list-item",active:!1,allow_multiple_actives:"one-per-parent",expandable:!1,click_callback:u}}});var a=[];$.each(j,function(c,b){var d=[];$.each(b.props,function(a,c){d.push({title:c.title,
type:"setting-prop",setting:b.name,prop:c.name})});a.push({title:b.title,type:"setting",setting:b.name,children:d})});Sydney["list-nav"].renderAndShowList(h,[{title:t("settings.title"),children:a}]);$.each(j,function(a,b){c[b.name]={prop:b.defaultProp,ts:0};var d=b.name,f;Sydney["user-data"].getOfflineData(g+d,function(a){_.isObject(a)&&(_.isString(a.prop)&&_.isNumber(a.ts))&&(f=_.findIndex(b.props,function(b){return b.name===a.prop}),-1!==f&&(c[d]=a));p(d,!0);k(d,c[d]);b.update_callback(c[d].prop,
null,!0)})})},getTextSize:function(){return"medium"},getAnimationsEnabled:function(){return!0},changeActiveSettingProp:m}}();
